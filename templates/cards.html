<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>{{ title }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .card-box {
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .share-btn {
            cursor: pointer;
        }
    </style>
</head>
<body class="bg-light">
<div class="container py-4">
    <h1 class="mb-4 text-center fw-bold text-primary">{{ title }}</h1>

    <div class="mb-3 d-flex gap-2 flex-wrap justify-content-center">
        <input type="text" id="searchInput" class="form-control w-auto" placeholder="Buscar por nombre...">
        <select id="categoryFilter" class="form-select w-auto">
            <option value="">Todas las categorÃ­as</option>
        </select>
        <select id="poolFilter" class="form-select w-auto">
            <option value="">Todos los pools</option>
        </select>
        <button class="btn btn-outline-secondary share-btn" onclick="copyLink()">
            ðŸ”— Copiar link
        </button>
    </div>

    <div class="row" id="cardsContainer">
        {% for item in data %}
        <div class="col-md-4 mb-4 card-item" data-nombre="{{ item['Nombre y Apellido'] }}" data-categoria="{{ item['CategorÃ­a'] }}" data-pool="{{ item['Pool'] }}">
            <div class="card card-box p-3">
                <h5 class="card-title text-primary fw-bold">{{ item['Nombre y Apellido'] }}</h5>
                <p><strong>CategorÃ­a:</strong> {{ item['CategorÃ­a'] }}</p>
                <p><strong>Kata:</strong> {{ item['Nombre Kata'] }}</p>
                <p><strong>Tatami:</strong> {{ item['Tatami'] }}</p>
                <p><strong>Pool:</strong> {{ item['Pool'] }}</p>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<script>
    const searchInput = document.getElementById('searchInput');
    const categoryFilter = document.getElementById('categoryFilter');
    const poolFilter = document.getElementById('poolFilter');
    const cards = document.querySelectorAll('.card-item');

    function filterCards() {
        const search = searchInput.value.toLowerCase();
        const category = categoryFilter.value;
        const pool = poolFilter.value;

        cards.forEach(card => {
            const name = card.dataset.nombre.toLowerCase();
            const cat = card.dataset.categoria;
            const poolValue = card.dataset.pool;
            const visible = name.includes(search) &&
                            (category === '' || cat === category) &&
                            (pool === '' || poolValue === pool);
            card.style.display = visible ? '' : 'none';
        });
    }

    searchInput.addEventListener('input', filterCards);
    categoryFilter.addEventListener('change', filterCards);
    poolFilter.addEventListener('change', filterCards);

    window.onload = () => {
        const categories = [...new Set(Array.from(cards).map(c => c.dataset.categoria))];
        categories.forEach(c => {
            const opt = document.createElement('option');
            opt.value = opt.textContent = c;
            categoryFilter.appendChild(opt);
        });

        const pools = [...new Set(Array.from(cards).map(c => c.dataset.pool))];
        pools.forEach(p => {
            const opt = document.createElement('option');
            opt.value = opt.textContent = p;
            poolFilter.appendChild(opt);
        });
    };

    function copyLink() {
        navigator.clipboard.writeText(window.location.href).then(() => {
            alert("Link copiado al portapapeles ðŸ“Ž");
        });
    }
</script>
</body>
</html>